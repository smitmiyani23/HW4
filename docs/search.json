[
  {
    "objectID": "HW4_Adv_Func.html",
    "href": "HW4_Adv_Func.html",
    "title": "ST558 HW4: Hodge Podge",
    "section": "",
    "text": "General practice in working with advanced functions.\n\n\nknitr::opts_chunk$set(message = TRUE, warning = TRUE)\n\n#Remove Warnings"
  },
  {
    "objectID": "HW4_Adv_Func.html#task-1-conceptual-questions",
    "href": "HW4_Adv_Func.html#task-1-conceptual-questions",
    "title": "ST558 HW4: Hodge Podge",
    "section": "Task 1: Conceptual Questions",
    "text": "Task 1: Conceptual Questions\n\nWhat is the purpose of the lapply() function? What is the equivalent purrr function?\n\nThe purpose of lapply(): lapply() in R is used to apply a function to each element of a list or vector, returning a list of the results. In the purrr package, the equivalent function to lapply() is map().\n\nSuppose we have a list called my_list. Each element of the list is a numeric data frame (all columns are numeric). We want use lapply() to run the code cor(numeric_matrix, method = \"kendall\") on each element of the list. Write code to do this below\n\nlapply(my_list, function(df) cor(df, method = \"kendall\")).\n\nWhat are two advantages of using purrr functions instead of the BaseR apply family?\n\n1. purrr functions always return outputs in a predictable format (usually a list), regardless of the input data structure. making it easier to work with results consistently across different scenarios.\n2. purrr integrates with other purrr functions and the tidyverse ecosystem very well, making it easier to combine operations and make chaining easy thus reduces the need for writing custom helper functions.\n\nWhat is a side-effect function?\n\nA side effect function is a function that not only computes a result but also performs actions that may alter the program’s state or interact with the external environment.\n\nWhy can you name a variable sd in a function and not cause any issues with the sd function?\n\nBecause R keeps track of variables separately within each function. When R sees sd inside the function, it looks first at the function’s own set of variables before checking if sd is a function. This avoids conflicts and lets us use the same name sd for a variable without affecting how the sd function works globally."
  },
  {
    "objectID": "HW4_Adv_Func.html#task-2-writing-r-functions",
    "href": "HW4_Adv_Func.html#task-2-writing-r-functions",
    "title": "ST558 HW4: Hodge Podge",
    "section": "Task 2: Writing R Functions",
    "text": "Task 2: Writing R Functions\n\nLoading Packages\nReading required tidyverse packages:\n\nlibrary(tidyverse)\n\nWarning: package 'tidyr' was built under R version 4.3.1\n\n\nWarning: package 'readr' was built under R version 4.3.1\n\n\nWarning: package 'dplyr' was built under R version 4.3.1\n\n\nWarning: package 'lubridate' was built under R version 4.3.1\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\n\n\nQuestion 1: Creating getRMSE() function\nCreating a function getRMSE that takes in vector of observations, and predictions and returns RMSE. Using … to have additional arguments for handling of NA values which would be used within the mean() function.\n\ngetRMSE &lt;- function(responses, predictions, ...) {\n  # Ensuring the responses and predictions are numeric vectors of the same length\n  if (length(responses) != length(predictions) | (!is.numeric(responses)) | (!is.numeric(predictions))) {\n    stop(\"Input vectors 'responses' and 'predictions' must be numeric and of the same length.\")\n  }\n  # Calculating RMSE. \n  rmse &lt;- sqrt(mean((responses - predictions)^2, ...))\n  \n  return(rmse)\n}\n\n\n\nQuestion 2: Testing the getRMSE() function\nGenerating data (code given in assignment) to test the getRMSE() function.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n\nTesting with no NA values\nTesting getRMSE() with resp and pred .\n\ngetRMSE(responses = resp,predictions = pred)\n\n[1] 0.9581677\n\n\n\n\nTesting with vectors containing NA_real_\nReplacing two random observations (choosing index at random using sample() from 1: length(resp) in resp with NA_real_ .\n\nset.seed(55)\n\nrandom_index &lt;- sample(1:length(resp),size = 2)\n\nresp[random_index[1]] &lt;- NA_real_\nresp[random_index[2]] &lt;- NA_real_\n\nsum(is.na(resp))\n\n[1] 2\n\n\n\nRMSE without handling NA\n\ngetRMSE(predictions = pred,responses = resp)\n\n[1] NA\n\n\n\n\nRMSE with an argument for handling NA\n\ngetRMSE(predictions = pred,responses = resp, na.rm = TRUE)\n\n[1] 0.9542739\n\n\n\n\n\n\nQuestion 3: Creating getMAE() function\nCreating getMAE() function similar to getRMSE()\n\ngetMAE &lt;- function(responses, predictions, ...) {\n  # Ensuring the responses and predictions are numeric vectors of the same length\n  if (length(responses) != length(predictions) | (!is.numeric(responses)) | (!is.numeric(predictions))) {\n    stop(\"Input vectors 'responses' and 'predictions' must be numeric and of the same length.\")\n  }\n  # Calculating MAE \n  mae &lt;- mean(abs(responses - predictions), ...)\n  \n  return(mae)\n}\n\n\n\nQuestion 4: Testing the getMAE() function\nGenerating data (code given in assignment) to test the getMAE() function.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n\nTesting with no NA values\nTesting getMAE() with resp and pred .\n\ngetMAE(responses = resp,predictions = pred)\n\n[1] 0.8155776\n\n\n\n\nTesting with vectors containing NA_real_\nReplacing two random observations (choosing index at random using sample() from 1: length(resp) in resp with NA_real_ .\n\nset.seed(35)\n\nrandom_index &lt;- sample(1:length(resp),size = 2)\n\nresp[random_index[1]] &lt;- NA_real_\nresp[random_index[2]] &lt;- NA_real_\n\nsum(is.na(resp))\n\n[1] 2\n\n\n\nMAE without handling NA\n\ngetMAE(predictions = pred,responses = resp)\n\n[1] NA\n\n\n\n\nMAE with an argument for handling NA\n\ngetMAE(predictions = pred,responses = resp, na.rm = TRUE)\n\n[1] 0.8089497\n\n\n\n\n\n\nQuestion 5: Wrapper Function\nCreating getMetrics() which calls the helper function\n\ngetMetrics &lt;- function(responses, predictions,metric = \"BOTH\", ...) {\n  # Ensuring the responses and predictions are numeric vectors of the same length\n  if (length(responses) != length(predictions) | (!is.numeric(responses)) | (!is.numeric(predictions)) | (!is.vector(responses)) | (!is.vector(responses))) {\n    stop(\"Input vectors 'responses' and 'predictions' must be numeric and of the same length.\")\n  }\n  # Calculating metrics \n  RMSE&lt;- getRMSE(responses = responses, predictions = predictions,...)\n  MAE &lt;- getMAE(responses = responses, predictions = predictions,...)\n  \n  METRICS &lt;- c(RMSE,MAE)\n  names(METRICS) &lt;- c(\"RMSE\",\"MAE\")\n  \n  if (metric == \"BOTH\"){\n    return(METRICS)\n  } else if (metric == \"RMSE\"){\n    return(METRICS[1])\n  } else if (metric == \"MAE\"){\n    return(METRICS[2])\n  } else {\n    \"Choose RMSE,MAE or BOTH\"\n  }\n}\n\n\n\nQuestion 6: Testing getMetrics()\nGenerating data (code given in assignment) to test the getMetrics() function.\n\nset.seed(10)\nn &lt;- 100\nx &lt;- runif(n)\nresp &lt;- 3 + 10*x + rnorm(n)\npred &lt;- predict(lm(resp ~ x), data.frame(x))\n\n\nCalling specific metric\n\nCalling for RMSE\n\ngetMetrics(predictions = pred,responses = resp,metric = \"RMSE\")\n\n     RMSE \n0.9581677 \n\n\n\n\nCalling for MAE\n\ngetMetrics(predictions = pred,responses = resp,metric = \"MAE\")\n\n      MAE \n0.8155776 \n\n\n\n\nCalling for BOTH\n\ngetMetrics(predictions = pred,responses = resp,metric = \"BOTH\")\n\n     RMSE       MAE \n0.9581677 0.8155776 \n\n\n\n\n\nTesting with NA values\nReplacing two random observations similar to previous instance.\n\nset.seed(45)\n\nrandom_index &lt;- sample(1:length(resp),size = 2)\n\nresp[random_index[1]] &lt;- NA_real_\nresp[random_index[2]] &lt;- NA_real_\n\nsum(is.na(resp))\n\n[1] 2\n\n\n\ngetMetrics without handling NA\n\ngetMetrics(predictions = pred,responses = resp)\n\nRMSE  MAE \n  NA   NA \n\n\n\n\ngetMetrics with an argument for handling NA\n\ngetMetrics(predictions = pred,responses = resp, na.rm = TRUE)\n\n     RMSE       MAE \n0.9638196 0.8199386 \n\n\n\n\ngetMetrics with incorrect data\nPassing in a dataframe instead of a vector.\n\ngetMetrics(predictions = data.frame(x),responses = resp, na.rm = TRUE)\n\nError in getMetrics(predictions = data.frame(x), responses = resp, na.rm = TRUE): Input vectors 'responses' and 'predictions' must be numeric and of the same length."
  },
  {
    "objectID": "HW4_Adv_Func.html#task-3-quering-an-api-and-a-tidy-style-function",
    "href": "HW4_Adv_Func.html#task-3-quering-an-api-and-a-tidy-style-function",
    "title": "ST558 HW4: Hodge Podge",
    "section": "Task 3: Quering an API and a Tidy-Style Function",
    "text": "Task 3: Quering an API and a Tidy-Style Function\nNecessary Packages:\n\nlibrary(httr)\nlibrary(jsonlite)\n\n\nAttaching package: 'jsonlite'\n\n\nThe following object is masked from 'package:purrr':\n\n    flatten\n\n\n\nQuestion 1: Querying the API and storing as JSON .\n\n\nUsing a URL to query the News API for top headlines using GET(), then retrieing raw content, converting it to a character string with rawToChar(), and parsing it into a structured R object using fromJSON().\n\nurl &lt;- \"https://newsapi.org/v2/top-headlines?country=gb&q=Euro&from=2024-05-25&to=2024-06-25&category=sports&apiKey=&lt;key_stored_locally&gt;\" \n\nnews &lt;- GET(url)\nnews_data &lt;- rawToChar(news$content)\nnews_json &lt;- fromJSON(news_data)\n\n\n\n\nQuestion 2: Returning the dataframe with articles information .\nExtracting news_json$articles which contains the all the information about articles as dataframe.\n\nnews_json$articles\n\nNULL\n\n\n\n\nQuestion 3: Creating a Tidy Style Function for Querying NewsAPI .\n\nCreating the function\nCreating a function to query the API using a keyword, from_date and key as an input.\n\nnews_api &lt;- function(keyword, from_date, api_key) {\n  base_url &lt;- \"https://newsapi.org/v2/top-headlines\"\n  \n  # Construct the URL with parameters\n  url &lt;- modify_url(\n    base_url,\n    query = list(\n      q = keyword,\n      from = from_date,\n      to = Sys.Date(),  # Today\n      apiKey = api_key\n    )\n  )\n  \n  # Make the API request\n  news &lt;- GET(url)\n  news_data &lt;- rawToChar(news$content)\n  news_json &lt;- fromJSON(news_data)\n  news_json$articles\n  \n}\n\n\n\nTesting the function\nTesting the function using the keyword = “Euro”, from_date = “2024-05-25”\n\nhead(news_api(keyword = \"Euro\",from_date = \"2024-05-25\",api_key = \"e715bbaccd5849a0baf5c9fa6eb42a68\"))\n\n      source.id source.name             author\n1       reuters     Reuters        Andrew Gray\n2     bbc-sport   BBC Sport               &lt;NA&gt;\n3     bbc-sport   BBC Sport               &lt;NA&gt;\n4     bbc-sport   BBC Sport               &lt;NA&gt;\n5 four-four-two FourFourTwo          Joe Mewis\n6 four-four-two FourFourTwo Callum Rice-Coates\n                                                                                      title\n1                 Ukraine set for symbolic start of EU membership talks, along with Moldova\n2                           Euro 2024: England qualify for last 16 after Spain beat Albania\n3                 Albania 0-1 Spain: Ferran Torres goal secures Euro 2024 100% group record\n4                                                          Croatia vs Italy: UEFA Euro 2024\n5  WATCH: Copa America wheels out brilliant Euros innovation that's been missing in Germany\n6 ‘It’s hard to watch’ Wayne Rooney offers sympathy to Luka Modric after Croatia heartbreak\n                                                                                                                                                                                                                                    description\n1 The European Union will open membership talks with Ukraine on Tuesday, giving the country a political boost in the midst of its war against Russia's invasion, although a long and tough road still lies ahead before it could join the bloc.\n2                                                                                                                                   England qualify for the last 16 of Euro 2024 with a group game to spare after Spain beat Albania on Monday.\n3                                                                                                                     Spain get the better of Albania as an early goal from Ferran Torres in Dusseldorf extends their 100% record at Euro 2024.\n4                                                                                                                                        Follow live text commentary, score updates and match stats from Croatia vs Italy in the UEFA Euro 2024\n5                                                                                                                                    The tiny car was one of our favourite Euro 2020 innovations and it's now headed stateside for Copa America\n6                                                                                                                                                     Croatia conceded a dramatic late equaliser against Italy in their crucial Euro 2024 clash\n                                                                                                                      url\n1      https://www.reuters.com/world/europe/ukraine-set-symbolic-start-eu-membership-talks-along-with-moldova-2024-06-25/\n2                                                               http://www.bbc.co.uk/sport/football/articles/cx000e5xj1zo\n3                                                                   http://www.bbc.co.uk/sport/football/live/cn00v9krdg9t\n4                                                                   http://www.bbc.co.uk/sport/football/live/cpvvg6kdgrvt\n5 https://www.fourfourtwo.com/news/watch-copa-america-wheels-out-brilliant-euros-innovation-thats-been-missing-in-germany\n6                                             https://www.fourfourtwo.com/news/wayne-rooney-luka-modric-croatia-euro-2024\n                                                                                                                                                                            urlToImage\n1 https://www.reuters.com/resizer/v2/KYYT63NDQVI2VENML2LZ7WBKOA.jpg?auth=3c4ac6f4c29e6ca4cb659a24c0bf06466cc40b799f7deb657cf5157eb8b7ce4f&height=1005&width=1920&quality=80&smart=true\n2                                                                                  https://ichef.bbci.co.uk/news/1024/branded_sport/77cd/live/f3e87570-3238-11ef-bc72-51b61c17135e.jpg\n3                                                                                   https://static.files.bbci.co.uk/ws/simorgh-assets/public/sport/images/metadata/poster-1024x576.png\n4                                                                                   https://static.files.bbci.co.uk/ws/simorgh-assets/public/sport/images/metadata/poster-1024x576.png\n5                                                                                                                 https://cdn.mos.cms.futurecdn.net/x4ZMz8RiEH3xaHxxLmwVyC-1200-80.jpg\n6                                                                                                                 https://cdn.mos.cms.futurecdn.net/5jtq6K4KLmQy2D3JhKSRbX-1200-80.jpg\n                   publishedAt\n1         2024-06-25T00:07:19Z\n2 2024-06-24T22:07:18.5807287Z\n3 2024-06-24T22:07:15.5658533Z\n4 2024-06-24T22:07:12.6899581Z\n5         2024-06-24T22:00:55Z\n6         2024-06-24T21:58:08Z\n                                                                                                                                                                                                                   content\n1                                                                                                                                                                                                                     &lt;NA&gt;\n2  England have qualified for the last 16 of Euro 2024 with a group game to spare after Spain beat Albania 1-0 on Monday.\\r\\nVictory for Luis de la Fuente's side also means the Netherlands and France prog… [+939 chars]\n3 Three-time European champions Spain had already secured top spot thanks to wins over Croatia and Italy, so coach Luis de la Fuente was able to make 10 changes to his starting line-up.\\r\\nThe substituti… [+1514 chars]\n4  Croatias players collapsed to the ground at the final whistle, while their fans stood motionless in the stands, staring in disbelief at what had just unfolded.\\r\\nThe 2018 World Cup finalists had been … [+960 chars]\n5   As we reach the tail end of the Euro 2024 group stage, the tournament in Germany has been pretty entertaining so far. We’ve had brilliant goals, last-minute winners, an under-the-radar instant classi… [+2323 chars]\n6 Wayne Rooney was quick to offer his condolences to Luka Modric after Croatia were all but knocked out of Euro 2024 after conceding a late equaliser against Italy.\\r\\nThe former Manchester United strike… [+1744 chars]\n\n\nTrying with different keyword and different data\n\nhead(news_api(keyword = \"UEFA\",from_date = \"2024-06-05\",api_key = \"e715bbaccd5849a0baf5c9fa6eb42a68\"))\n\n         source.id      source.name                   author\n1        bbc-sport        BBC Sport                     &lt;NA&gt;\n2             espn             ESPN                     &lt;NA&gt;\n3 goteborgs-posten Göteborgs-Posten Kasper Ljungström/TT, TT\n4          lequipe         L'equipe                 L'EQUIPE\n                                                                                                           title\n1                                                                               Croatia vs Italy: UEFA Euro 2024\n2                                                          Croatia 1-1 Italy (Jun 24, 2024) Game Analysis - ESPN\n3                                                                     Danmark straffas av Uefa – efter banderoll\n4 L'UEFA a donné des consignes de sécurité aux supporters de Manchester City avant la finale de la Ligue des ...\n                                                                                                                                                                                                                                                           description\n1                                                                                                                                                               Follow live text commentary, score updates and match stats from Croatia vs Italy in the UEFA Euro 2024\n2                                                                                                                                                  Expert recap and game analysis of the Croatia vs. Italy Uefa European Championship game from June 24, 2024 on ESPN.\n3 Enligt danska &lt;a href=\"https://sport.tv2.dk/fodbold/2024-06-23-dbu-straffet-vil-finde-de-skyldige\" id=\"Jc5e98ssZRdLn20C\"&gt;TV2&lt;/a&gt; har det danska fotbollsförbundet straffats med böter.&lt;br/&gt;Detta efter att en dansk supporter hållit upp en banderoll med budskapet…\n4 Selon le « Daily Mail », l'UEFA a envoyé ses consignes de sécurité aux supporters de Manchester City avant la finale de Ligue des champions qui opposera les Citizens à l'Inter, samedi, à Istanbul (21 heures). Un an après les incidents du Stade de France, l'in…\n                                                                                                                                                                      url\n1                                                                                                                   http://www.bbc.co.uk/sport/football/live/cpvvg6kdgrvt\n2                                                                                                                      https://www.espn.com/soccer/report/_/gameId/690599\n3                                                                    http://www.gp.se/sport/danmark-straffas-av-uefa-efter-banderoll.03a8d9ed-3166-53dc-b557-1cfa904d5bb9\n4 https://www.lequipe.fr/Football/Actualites/L-uefa-a-donne-des-consignes-de-securite-aux-supporters-de-manchester-city-avant-la-finale-de-la-ligue-des-champions/1401508\n                                                                                                                                                                                        urlToImage\n1                                                                                               https://static.files.bbci.co.uk/ws/simorgh-assets/public/sport/images/metadata/poster-1024x576.png\n2                                                                                                                           https://a.espncdn.com/combiner/i?img=/i/espn/misc_logos/500/soccer.png\n3                                                                                 https://www.gp.se/images/og/03a8d9ed-3166-53dc-b557-1cfa904d5bb9/images/1VVjOncsbqLWmJWWnERX2713ID1Q-REGULAR.jpg\n4 https://medias.lequipe.fr/img-photo-jpg/les-supporters-de-manchester-city-devront-arriver-au-stade-avec-neuf-heures-d-avance-selon-le-daily-/1500000001795954/0:0,1997:1332-640-427-75/21760.jpg\n                   publishedAt\n1 2024-06-24T22:07:12.6899581Z\n2 2024-06-24T21:22:12.1904812Z\n3         2024-06-24T10:24:55Z\n4    2023-06-08T14:11:05+00:00\n                                                                                                                                                                                                                  content\n1 Croatias players collapsed to the ground at the final whistle, while their fans stood motionless in the stands, staring in disbelief at what had just unfolded.\\r\\nThe 2018 World Cup finalists had been … [+960 chars]\n2  An added time goal from Italy's Mattia Zaccagni snatched a 1-1 draw with Croatia which was enough to earn them a place in the last 16 of Euro 2024 as Group B runners-up where they will face Switzerla… [+1059 chars]\n3 Boten ska enligt den danska sajten ligga på 10 000 euro, motsvarande drygt 112 000 svenska kronor.\\r\\nErik Brøgger Rasmussen, direktör för det danska fotbollsförbundet, berättar att förbundet kommer at… [+708 chars]\n4   Un an après les incidents au Stade de France et le traumatisme de milliers de supporters anglais, l'UEFA voudrait s'assurer que de tels dysfonctionnements ne se reproduisent plus. Le 28 mai 2022, l'a… [+485 chars]"
  }
]